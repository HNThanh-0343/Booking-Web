@model WEBSITE_TRAVELBOOKING.Models.SysRoom;
@using WEBSITE_TRAVELBOOKING.Helper;
@using WEBSITE_TRAVELBOOKING.Models;
@{
    ViewData["TitleAdmin"] = "Chi tiết phòng";
    var getAccount = Account.GetAccount();
    var TienNghi = ViewBag.TienNghi as List<CatAminitieseRoom>;
    var getHotel = ViewBag.GetHotel as SysHotel;
    var getTypeRoom = ViewBag.typeRoom as CatTypeRoom;
    var typeBed = ViewBag.CatTypeBed as CatBedRoom;
    var ruleAction = ViewData["RuleAll"] as ModelsAndRole;
}
@*Thư viện soạn thảo*@
<link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.18/summernote-bs4.min.css" rel="stylesheet">
<style>
    .imgKS {
        max-height: 158px;
        min-height: 158px;
    }
</style>
<div class="modal-header">
    <h5 class="modal-title" id="scrollableModalTitle">@ViewData["TitleAdmin"]</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-hidden="true"></button>
</div>
<div class="modal-body">
    <form class="needs-validation" id="dataForm" method="post" enctype="multipart/form-data" novalidate>
        <input type="number" id="idRoom" name="Id" value="@Model.Id" hidden />
        <div class="row">
            <div class="col-md-12 mb-2">
                <div class="mainslider w-10">
                    <div class="sliderKS">
                        @{
                            var listHinhAnh = "";
                            if (string.IsNullOrEmpty(Model.ListImg))
                            {
                                listHinhAnh = "/AppData/no-image.png";
                                <div>
                                    <img src="@listHinhAnh" alt="image" class="img-thumbnail imgKS" width="300" />
                                </div>
                            }
                            else
                            {
                                var listIMG = Model.ListImg.Split(',');
                                foreach (var item in listIMG)
                                {
                                    listHinhAnh = Common.GetImagePath(item);
                                    if (listIMG.Length > 5)
                                    {
                                        if (listHinhAnh != "/AppData/no-image.png")
                                        {
                                            <div>
                                                <img src="@listHinhAnh" class="img-thumbnail imgKS" alt="image" width="300" />
                                            </div>
                                        }
                                    }
                                    else
                                    {
                                        <div>
                                            <img src="@listHinhAnh" class="img-thumbnail imgKS" alt="image" width="300" />
                                        </div>
                                    }
                                }
                            }
                        }
                    </div>
                </div>
            </div>
            <h4 class="mt-2 mb-2">@Model.Name</h4>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Tầng:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.Floor</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Số phòng:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.NumRoom</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Tổng số phòng:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.TotalRoom</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Loại phòng nghỉ:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@getTypeRoom?.Name</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Loại giường:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@typeBed?.Name</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Giá:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.Price?.ToString("N0") VNĐ</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Số lượng người lớn:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.AdultsMax</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group row">
                    <label class="form-label text-end col-md-4">Số lượng trẻ em:</label>
                    <div class="col-md-8">
                        <p class="form-control-static">@Model.ChildrenMax</p>
                    </div>
                </div>
            </div>

            <h4 class="mt-2">Nội dung</h4>
            <div class="mb-3">
                <div class="p-2" style="text-align:justify">@Html.Raw(Model.Description)</div>
            </div>

            <h4 class="mt-2">Tiện nghi được ưa chuộng</h4>
            <div class="mb-3">
                <div class="p-2 row">
                    @{
                        var selectedAmenities = (Model.ListAminities ?? "").Split(',').ToList();
                        var tienNghiHotel = (getHotel.Amenities ?? "").Split(',').ToList();
                        foreach (var item in TienNghi)
                        {
                            if (selectedAmenities.Count > 0)
                            {
                                if (selectedAmenities.Contains(item.Id.ToString()))
                                {
                                    <div class="col-2 row mb-2">
                                        <div class="col-3">
                                            <span><i class="@item.Icon"></i></span>
                                        </div>
                                        <div class="col-9">
                                            <span>@item.Name</span>
                                        </div>
                                    </div>
                                }
                            }
                            else
                            {
                                if (tienNghiHotel.Contains(item.Id.ToString()))
                                {
                                    <div class="col-2 row mb-2">
                                        <div class="col-3">
                                            <span><i class="@item.Icon"></i></span>
                                        </div>
                                        <div class="col-9">
                                            <span>@item.Name</span>
                                        </div>
                                    </div>
                                }
                            }
                        }
                    }
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
    @if (ruleAction != null && ruleAction.IsDelete == true && ViewBag.hideBtn)
    {
        <button type="button" data-toggle="ajax-modal" data-url="@Url.Action("xoaPhong", new { id = Model.Id, area = "Admin" })" class="btn bg-danger-subtle delete text-danger waves-effect text-start">
            Xóa
        </button>
    }
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.18/summernote-bs4.min.js"></script>
<script>
    $('.sliderKS').slick({
        dots: false,
        infinite: true,
        speed: 300,
        slidesToShow: 3,
        centerMode: true,
        autoplay: true,        // tự động chuyển
        autoplaySpeed: 2000,   // thời gian chuyển (ms)
        arrows: false // 👈 Tắt cả hai nút
    });
</script>